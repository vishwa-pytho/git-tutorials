utility functions version 5