utility functions version 4